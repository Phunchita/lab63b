# การทดลองที่ 7 เซนเซอร์แสงเปิดปิดไฟอัตโนมัติ
## วัตถุประสงค์
1. เพื่อนำการทดลองที่ 4 เรื่องการเขียนโปรแกรมอินพุทสัญญาณดิจิทัลมาต่อยอดเพื่อพัฒนาโปรแกรม
2. เพื่อให้นักศึกษามีทักษะความคิดสร้างสรรค์ในการเขียนโปรแกรมมากขึ้น
## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์ ชนิดESP_01![image](https://user-images.githubusercontent.com/80879365/112280582-bea01c80-8cb7-11eb-9b7c-48a2639f3094.png)
2. USB to serial port
3. อุปกรณ์ต่อพ่วงUSB
4. อุปกรณ์ที่ป้อนข้อมูลเข้าไมโครคอนโทรเลอร์ เช่นคอมพิวเตอร์
5. อะแดปเตอร์ แสดงผลเป็นLED
6. เซนเซอร์แสงLDR 
7. ตัวต้านทาน
## ศึกษาข้อมูลเพิ่มเติม
* [ทำความรู้จัก ไมโครคอนโทรเลอร์ ESP_01](https://docs.platformio.org/en/latest/boards/espressif8266/esp01.html)
* [วีดีโอการทดลองแลป4](https://www.youtube.com/watch?v=nFqoZT26U5k)
* [ตัวอย่างโปรแกรมที่4](https://github.com/choompol-boonmee/lab63b/tree/master/examples/04_Input-Port)
* [ศึกษาการทำงานของ ESP8266 เพิ่มเติม](https://nurdspace.nl/ESP8266#Code_examples)
## วิธีการทำการทดลอง
1. ต่อ USB to serial port เข้ากับอแดปเตอร์พอร์ต0และ1 และ ไมโครคอนโทรเลอร์ และคอมพิวเตอร์เข้าด้วยกันดังภาพด้านขวา![image](https://user-images.githubusercontent.com/80879365/112296432-7d176d80-8cc7-11eb-8ec1-c189472eef10.png)
2. เปิด command prompt 
3. ทำการตั้งค่าเซตอัพตัวเซนเซอร์แสงทางรูปขวาด้านบน
``` #include <Arduino.h>
#include <ESP8266WiFi.h>

int cnt = 0;

void setup()
{
	Serial.begin(9600);
	pinMode(0, INPUT);                     //พอร์ตสีขาว
	pinMode(2, OUTPUT);                    //พอร์ตสีเหลือง
	Serial.println("\n\n\n");
}

void loop()
{
	int val = digitalRead(0);
	Serial.printf("======= read %d\n", val);
	if(val==1) {
		digitalWrite(2, HIGH);        //เป็น1ไฟติด
	} else {
		digitalWrite(2, LOW);
	}
	delay(500);
}
```
4. อัพโหลดโปรแกรมตัวอย่างลงไมโครคอนโทรเลอร์ ด้วยคำสั่ง `pio run-t upload`![image](https://user-images.githubusercontent.com/80879365/112297051-ffa02d00-8cc7-11eb-8c9e-d8db657e31eb.png)   
5. เมื่อโปรแกรมกำลังรันให้กดปุ่มอัปโหลด สีดำที่บอร์ดค้างไว้ แล้วกดปุ่มสีแดงหนึ่งครั้งเพิ่อรีเซต![image](https://user-images.githubusercontent.com/80879365/112297180-25c5cd00-8cc8-11eb-9424-19df25f9c8d2.png)
6. รอจนกระทั่งรันโปรแกรมจบแล้ว ใช้คำสั่ง `pio device momitor` เพื่อดูผลผ่านคอมพิวเตอร์![image](https://user-images.githubusercontent.com/80879365/112297299-4c840380-8cc8-11eb-9c0d-9af4e28864e3.png)
7. ปิดหน้าสัมผัสเซนเอร์แสง สังเกตที่หลอดไฟLED
## การบันทึกผลการทดลอง
* ปิดหน้าสัมผัสเซนเอร์แสงค่าที่เซนเซอร์อ่านได้จะเป็นค่า 1 และสังเกตุได้ว่าไฟLEDติด
* เปิดหน้าสัมผัสเซนเซอร์แสงค่าที่เซนเซอร์อ่านได้จะเป็นค่า 0 สังเกตุได้ว่าไฟLEDดับ
## อภิปรายผลการทดลอง
* เนื่องจากคำสั่งที่สั่งจากในเซตอัพนั้น มีการสั่งให้เมื่อตัวเซนเซอร์ LDR เจอกับแสงธรรมชาติในตอนกลางวัน ไฟที่LEDจะดับ ในทางตรงกันข้ามเมื่อตอนกลางคืนLDR จะไม่เจอกับแสง จึงทำการสั่งให้ไฟLED ติด จึงทำให้เราได้ตัวเปิดเซนเซอร์แสงเปิดปิดไฟอัตโนมัติมาใช้ภายนอกอาคาร เช่นเสาร์ไฟสาธารณะ
## คำถามหลังการทดลอง
* void setup กับ void loopต่างกันอย่างไร
* ตอบ void setup จะเป็นพาร์ทที่ทำหน้าที่ของไมโครคอนโทรเลอร์ในส่วนการอ่านinput และการแสดงผลoutput ส่วน void loopจะเป็นคำสั่งภายในระบบตัวเซนเซอร์ LDR และทำหน้าที่ประมวลผลที่เกิดขึ้นจากinput 



  
                
          
            
